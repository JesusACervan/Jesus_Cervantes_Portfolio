import chardet

# Read a sample of the file
with open('/Users/jcervan/Desktop/DS4A Fall - Data Challenges/Retail/Data Sets/BigSupplyCo Data Files/BigSupplyCo_Orders.csv', 'rb') as file:
    raw_data = file.read(10000)  # Read the first 10,000 bytes
    result = chardet.detect(raw_data)

print(result)

import pandas as pd
order = pd.read_csv('/Users/jcervan/Desktop/DS4A Fall - Data Challenges/Retail/Data Sets/BigSupplyCo Data Files/BigSupplyCo_Orders.csv',encoding='MacRoman')

order.tail()

sum(order.duplicated())

order['Order Country'].unique()

citieswitherrors = order['Order State'].str.contains(r'[^a-zA-Z \-]')

errors = []
err2 = []
err3 = []


for i in range(len(order['Order State'])):
    if citieswitherrors[i] == 1:
        city = order['Order State'][i]
        if city not in errors:
            errors.append(city)
        else:
            continue
    else:
        continue


for er in errors:
    if 'Ã' in er:
        change = er[er.find('Ã'):er.find('Ã')+2]
        if change not in err2:
            err2.append(er)
        else:
            continue
    else:
        err3.append(er)

# print(err2)
# print(err3)

changes = {
    'Ãº': 'ú',
    'Ã£': 'ã',
    # 'Ã_': '||',  # This appears incomplete; you may want to decide how to handle it.
    'Ã¡': 'á',
    'Ã©': 'é',
    'ÃÅ': 'Á',
    'Ã«': 'ë',
    'Ã¯': 'ï',
    'Ã±': 'ñ',
    'Ã§': 'ç',
    'Ãµ': 'õ',
    'Ã¢': 'â',
    'Ã‡': 'Ç',
    'Ã¶': 'ö',
    'Ã¨': 'è',
    'Â’': '’',
    
    # '?': '||'   # The character ? can represent: in "Kahramanmara?" it stands for ş, in "Klaip?da" it represents ė, in "Bra?ov" it indicates ș, in "Gy?r" it denotes ő, and in "CoxÂ’s B?z?r" it signifies ā. 
}

erÃ_ = []
erÃÅ = []
erq = []

for er in errors:
    if 'Ã_' in er:
        if er not in erÃ_:
            erÃ_.append(er)
        else:
            continue
    elif 'ÃÅ' in er:
        if er not in erÃÅ:
            erÃÅ.append(er)
        else:
            continue
    elif '?' in er:
        if er not in erq:
            erq.append(er)
        else:
            continue

## Country
c = ['JapÃ_n', 'TurquÃ_a', 'PaÃ_ses Bajos', 'NÃ_ger', 'Arabia SaudÃ_', 'BenÃ_n', 'EtiopÃ_a', 'HungrÃ_a', 'HaitÃ_', 'GabÃ_n', 'LÃ_bano']
# ['Emiratos ÃÅrabes Unidos']

## City
ci = ['CamagÃ_ey', 'MaceiÃ_', 'HolguÃ_n', 'LeÃ_n', 'CÃ_rdoba', 'KÃ_tahya', 'BrasÃ_lia', 'MaturÃ_n', 'DublÃ_n', 'Pinar del RÃ_o', 'Santana de ParnaÃ_ba', 'BerlÃ_n', 'PekÃ_n', 'TeresÃ_polis', 'San MartÃ_n', 'VÃ_nnytsia', 'MedellÃ_n', 'EstelÃ_', 'Soledad DÃ_ez GutiÃ©rrez', 'AraguaÃ_na', 'GÃ_mez Palacio', 'San Francisco del RincÃ_n', 'San CristÃ_bal de Las Casas', 'MossorÃ_', 'Sancti SpÃ_ritus', 'El LimÃ_n', 'ColÃ_n', 'ObregÃ_n', 'San Luis RÃ_o Colorado', 'ConsolaciÃ_n del Sur', 'GÃ_mel', 'San Luis PotosÃ_', 'San Pedro de MacorÃ_s', 'BanÃ_', 'ChapecÃ_', 'JataÃ_', 'San Francisco de MacorÃ_s', 'ItajaÃ_', 'AsunciÃ_n', 'TorreÃ_n', 'San CristÃ_bal', 'VladÃ_mir', 'ConcepciÃ_n del Uruguay', 'ApatzingÃ¡n de la ConstituciÃ_n', 'VitÃ_ria', 'JamundÃ_', 'MorÃ_n', 'JacareÃ_', 'ValparaÃ_so', 'Lora del RÃ_o', 'PotosÃ_', 'SÃ£o LuÃ_s', 'LenÃ§Ã_is Paulista', 'PetrÃ_polis', 'BolÃ_var', 'IjuÃ_', 'Sahuayo de JosÃ© MarÃ_a Morelos', 'Fresnillo de GonzÃ¡lez EcheverrÃ_a', 'Garza GarcÃ_a', 'GirÃ_n', 'TernÃ_pil', 'JundiaÃ_', 'BahÃ_a Blanca', 'ValparaÃ_so de GoiÃ¡s', 'VorÃ_nezh', 'VitÃ_ria de Santo AntÃ£o', 'GravataÃ_', 'CopiapÃ_', 'QazvÃ_n', 'JersÃ_n', 'Ã_stÃ_ nad Labem', 'San Juan del RÃ_o', 'PatrocÃ_nio', 'QuibdÃ_', 'NiterÃ_i', 'RÃ_o Bravo', 'VitÃ_ria da Conquista', 'ZhytÃ_myr', 'GÃ_nzburg', 'BugÃ_a', 'LÃ_bano', 'DivinÃ_polis', 'RubÃ_', 'ApartadÃ_', 'CarapicuÃ_ba', 'TatuÃ_', 'Upplands VÃ_sby', 'Barra do PiraÃ_', 'JunÃ_n', 'MonterÃ_a', 'RondonÃ_polis']
# ['ÃÅguas Lindas de GoiÃ¡s', 'Ciego de ÃÅvila', 'Los ÃÅngeles']
ci2 = ['Kahramanmara?', 'Klaip?da', 'Aew?l-li', 'Bra?ov', 'Gy?r', 'CoxÂ’s B?z?r']

## State
s = ['PaÃ_ses del Loira', 'ChiriquÃ_', 'BahÃ_a', 'CamagÃ_ey', 'HolguÃ_n', 'MaraÃ±Ã_n', 'LeÃ_n', 'RÃ_o Negro', 'UmbrÃ_a', 'Norte-Paso de Calais-PicardÃ_a', 'Aquitania-LemosÃ_n-Poitou-Charentes', 'PaÃ_s Vasco', 'KÃ_tahya', 'MarÃ_tima', 'Languedoc-RosellÃ_n-MediodÃ_a-Pirineos', 'Nuevo LeÃ_n', 'GÃ_eldres', 'DublÃ_n', 'LombardÃ_a', 'AndalucÃ_a', 'EspÃ_ritu Santo', 'Pinar del RÃ_o', 'RÃ_o de Janeiro', 'CalabarzÃ_n', 'ChauÃ_a-Uardiga', 'AlejandrÃ_a', 'SofÃ_a-Ciudad', 'NormandÃ_a', 'BerlÃ_n', 'SurjandarÃ_n', 'PekÃ_n', 'LuzÃ_n Central', 'Auvernia-RÃ_dano-Alpes', 'MarkazÃ_', 'RÃ_os', 'NÃ_ger', 'VÃ_stra GÃ¶taland', 'Castilla y LeÃ_n', 'RegiÃ_n Capital', 'VÃ_rmland', 'GÃ_mel', 'VÃ_nnytsia', 'NÃ_nive', 'OregÃ_n', 'AntioquÃ_a', 'EstelÃ_', 'San Luis PotosÃ_', 'ParaÃ_ba', 'RÃ_o Grande del Norte', 'Sancti SpÃ_ritus', 'QuindÃ_o', 'ColÃ_n', 'PiauÃ_', 'BÃ_o-BÃ_o', 'Ciudad de AlmatÃ_', 'JunÃ_n', 'Entre RÃ_os', 'JorasÃ¡n RazavÃ_', 'San Pedro de MacorÃ_s', 'CÃ_rdoba', 'AsunciÃ_n', 'VladÃ_mir', 'ValparaÃ_so', 'ManabÃ_', 'DublÃ_n del Sur', 'BolÃ_var', 'San CristÃ_bal', 'KhÃ¡nh HÃ_a', 'PotosÃ_', 'FederaciÃ_n de Bosnia y Herzegovina', 'TernÃ_pil', 'ZhytÃ_myr', 'Puerto SaÃ_d', 'VorÃ_nezh', 'QazvÃ_n', 'JersÃ_n', 'NÃ_vgorod', 'Ã_stÃ_ nad Labem', 'ChocÃ_', 'BugÃ_a', 'LÃ_bano del Norte', 'Los RÃ_os', 'DÃ_zce']
# ['Ciego de ÃÅvila']
s2 = ['Th? DÃ´ HÃ\xa0 N?i', 'Kahramanmara?', 'Klaip?da', 'T?nh C?n Th?', 'Bra?ov', 'Gy?r']

comp = c + ci + ci2 + s + s2



# print(len(pd.DataFrame({'Errors': comp})['Errors'].unique()))
# print(erÃ_)
# print(erÃÅ)
# print(erq)

replacement = {
    'JapÃ_n': 'Japón',
    'TurquÃ_a': 'Turquía',
    'PaÃ_ses Bajos': 'Países Bajos',
    'NÃ_ger': 'Níger',
    'Arabia SaudÃ_': 'Arabia Saudita',
    'BenÃ_n': 'Benín',
    'EtiopÃ_a': 'Etiopía',
    'HungrÃ_a': 'Hungría',
    'HaitÃ_': 'Haití',
    'GabÃ_n': 'Gabón',
    'LÃ_bano': 'Líbano',
    'CamagÃ_ey': 'Camagüey',
    'MaceiÃ_': 'Maceió',
    'HolguÃ_n': 'Holguín',
    'LeÃ_n': 'León',
    'CÃ_rdoba': 'Córdoba',
    'KÃ_tahya': 'Kütahya',
    'BrasÃ_lia': 'Brasilia',
    'MaturÃ_n': 'Maturín',
    'DublÃ_n': 'Dublín',
    'Pinar del RÃ_o': 'Pinar del Río',
    'Santana de ParnaÃ_ba': 'Santana de Parnaíba',
    'BerlÃ_n': 'Berlín',
    'PekÃ_n': 'Pekín',
    'TeresÃ_polis': 'Teresópolis',
    'San MartÃ_n': 'San Martín',
    'VÃ_nnytsia': 'Vinnytsia',
    'MedellÃ_n': 'Medellín',
    'EstelÃ_': 'Estelí',
    'Soledad DÃ_ez GutiÃ©rrez': 'Soledad Díez Gutiérrez',
    'AraguaÃ_na': 'Araguaína',
    'GÃ_mez Palacio': 'Gómez Palacio',
    'San Francisco del RincÃ_n': 'San Francisco del Rincón',
    'San CristÃ_bal de Las Casas': 'San Cristóbal de Las Casas',
    'MossorÃ_': 'Mossoró',
    'Sancti SpÃ_ritus': 'Sancti Spíritus',
    'El LimÃ_n': 'El Limón',
    'ColÃ_n': 'Colón',
    'ObregÃ_n': 'Obregón',
    'San Luis RÃ_o Colorado': 'San Luis Río Colorado',
    'ConsolaciÃ_n del Sur': 'Consolación del Sur',
    'GÃ_mel': 'Gómez',
    'San Luis PotosÃ_': 'San Luis Potosí',
    'San Pedro de MacorÃ_s': 'San Pedro de Macorís',
    'BanÃ_': 'Baná',
    'ChapecÃ_': 'Chapecó',
    'JataÃ_': 'Jataí',
    'San Francisco de MacorÃ_s': 'San Francisco de Macorís',
    'ItajaÃ_': 'Itajaí',
    'AsunciÃ_n': 'Asunción',
    'TorreÃ_n': 'Torreón',
    'San CristÃ_bal': 'San Cristóbal',
    'VladÃ_mir': 'Vladimir',
    'ConcepciÃ_n del Uruguay': 'Concepción del Uruguay',
    'ApatzingÃ¡n de la ConstituciÃ_n': 'Apatzingán de la Constitución',
    'VitÃ_ria': 'Vitória',
    'JamundÃ_': 'Jamundí',
    'MorÃ_n': 'Morón',
    'JacareÃ_': 'Jacareí',
    'ValparaÃ_so': 'Valparaíso',
    'Lora del RÃ_o': 'Lora del Río',
    'PotosÃ_': 'Potosí',
    'SÃ£o LuÃ_s': 'São Luís',
    'LenÃ§Ã_is Paulista': 'Lençóis Paulista',
    'PetrÃ_polis': 'Petrópolis',
    'BolÃ_var': 'Bolívar',
    'IjuÃ_': 'Ijuí',
    'Sahuayo de JosÃ© MarÃ_a Morelos': 'Sahuayo de José María Morelos',
    'Fresnillo de GonzÃ¡lez EcheverrÃ_a': 'Fresnillo de González Echeverría',
    'Garza GarcÃ_a': 'Garza García',
    'GirÃ_n': 'Girona',
    'TernÃ_pil': 'Ternopil',
    'JundiaÃ_': 'Jundiaí',
    'BahÃ_a Blanca': 'Bahía Blanca',
    'ValparaÃ_so de GoiÃ¡s': 'Valparaíso de Goiás',
    'VorÃ_nezh': 'Voronezh',
    'VitÃ_ria de Santo AntÃ£o': 'Vitória de Santo Antão',
    'GravataÃ_': 'Gravataí',
    'CopiapÃ_': 'Copiapó',
    'QazvÃ_n': 'Qazvin',
    'JersÃ_n': 'Jersón',
    'Ã_stÃ_ nad Labem': 'Ústí nad Labem',
    'San Juan del RÃ_o': 'San Juan del Río',
    'PatrocÃ_nio': 'Patrocínio',
    'QuibdÃ_': 'Quibdó',
    'NiterÃ_i': 'Niterói',
    'RÃ_o Bravo': 'Río Bravo',
    'VitÃ_ria da Conquista': 'Vitória da Conquista',
    'ZhytÃ_myr': 'Zhytomyr',
    'GÃ_nzburg': 'Günzburg',
    'BugÃ_a': 'Buga',
    'DivinÃ_polis': 'Divinópolis',
    'RubÃ_': 'Rubí',
    'ApartadÃ_': 'Apartadó',
    'CarapicuÃ_ba': 'Carapicuíba',
    'TatuÃ_': 'Tatuí',
    'Upplands VÃ_sby': 'Upplands Väsby',
    'Barra do PiraÃ_': 'Barra do Piraí',
    'JunÃ_n': 'Junín',
    'MonterÃ_a': 'Montería',
    'RondonÃ_polis': 'Rondonópolis',
    'Kahramanmara?': 'Kahramanmaraş',
    'Klaip?da': 'Klaipėda',
    'Aew?l-li': 'Aewl-li',
    'Bra?ov': 'Brașov',
    'Gy?r': 'Győr',
    'CoxÂ’s B?z?r': 'Cox’s Bazar',
    'PaÃ_ses del Loira': 'Países del Loira',
    'ChiriquÃ_': 'Chiriquí',
    'BahÃ_a': 'Bahía',
    'MaraÃ±Ã_n': 'Marañón',
    'RÃ_o Negro': 'Río Negro',
    'UmbrÃ_a': 'Umbría',
    'Norte-Paso de Calais-PicardÃ_a': 'Norte-Paso de Calais-Picardía',
    'Aquitania-LemosÃ_n-Poitou-Charentes': 'Aquitania-Lemosín-Poitou-Charentes',
    'PaÃ_s Vasco': 'País Vasco',
    'MarÃ_tima': 'Marítima',
    'Languedoc-RosellÃ_n-MediodÃ_a-Pirineos': 'Languedoc-Rosellón-Mediodía-Pirineos',
    'Nuevo LeÃ_n': 'Nuevo León',
    'GÃ_eldres': 'Güeldres',
    'LombardÃ_a': 'Lombardía',
    'AndalucÃ_a': 'Andalucía',
    'EspÃ_ritu Santo': 'Espíritu Santo',
    'RÃ_o de Janeiro': 'Río de Janeiro',
    'CalabarzÃ_n': 'Calabarzon',
    'ChauÃ_a-Uardiga': 'Chauá-Uardiga',
    'AlejandrÃ_a': 'Alejandría',
    'SofÃ_a-Ciudad': 'Sofía-Ciudad',
    'NormandÃ_a': 'Normandía',
    'SurjandarÃ_n': 'Surjandaria',
    'LuzÃ_n Central': 'Luzón Central',
    'Auvernia-RÃ_dano-Alpes': 'Auvernia-Ródano-Alpes',
    'MarkazÃ_': 'Markaz',
    'RÃ_os': 'Ríos',
    'VÃ_stra GÃ¶taland': 'Västra Götaland',
    'Castilla y LeÃ_n': 'Castilla y León',
    'RegiÃ_n Capital': 'Región Capital',
    'VÃ_rmland': 'Värmland',
    'NÃ_nive': 'Nínive',
    'OregÃ_n': 'Oregón',
    'AntioquÃ_a': 'Antioquía',
    'ParaÃ_ba': 'Paraíba',
    'RÃ_o Grande del Norte': 'Río Grande del Norte',
    'QuindÃ_o': 'Quindío',
    'PiauÃ_': 'Piauí',
    'BÃ_o-BÃ_o': 'Bahía-Bahía',
    'Ciudad de AlmatÃ_': 'Ciudad de Almaty',
    'Entre RÃ_os': 'Entre Ríos',
    'JorasÃ¡n RazavÃ_': 'Jorasán Razaví',
    'ManabÃ_': 'Manabí',
    'DublÃ_n del Sur': 'Dublín del Sur',
    'KhÃ¡nh HÃ_a': 'Khánh Hòa',
    'FederaciÃ_n de Bosnia y Herzegovina': 'Federación de Bosnia y Herzegovina',
    'Puerto SaÃ_d': 'Puerto Saíd',
    'NÃ_vgorod': 'Nóvgorod',
    'ChocÃ_': 'Chocó',
    'LÃ_bano del Norte': 'Líbano del Norte',
    'Los RÃ_os': 'Los Ríos',
    'DÃ_zce': 'Düzce',
    'Th? DÃ´ HÃ\xa0 N?i': 'Thủ đô Hà Nội',
    'T?nh C?n Th?': 'Tỉnh Cần Thơ',
}

order['Order City'] = order['Order City'].replace(replacement)
order['Order State'] = order['Order State'].replace(replacement)
order['Order Country'] = order['Order Country'].replace(replacement)

order.head()

order['Order City'] = order['Order City'].replace(changes, regex = True)
order['Order State'] = order['Order State'].replace(changes,regex = True)
order['Order Country'] = order['Order Country'].replace(changes,regex = True)

order.to_csv('CorrectedBigSupplyCo_Orders.csv', index=False)
